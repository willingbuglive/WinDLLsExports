Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\System32\pnpdiag.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-sysinfo-l1-2-0.dll
    api-ms-win-core-registry-l1-1-0.dll
    api-ms-win-core-string-l1-1-0.dll
    api-ms-win-core-errorhandling-l1-1-0.dll
    api-ms-win-core-file-l1-1-0.dll
    CFGMGR32.dll
    api-ms-win-core-processenvironment-l1-1-0.dll
    api-ms-win-devices-config-l1-1-1.dll
    ntdll.dll
    api-ms-win-core-registry-l2-1-0.dll
    api-ms-win-core-synch-l1-2-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-timezone-l1-1-0.dll
    api-ms-win-core-handle-l1-1-0.dll
    api-ms-win-core-file-l2-1-0.dll
    api-ms-win-core-file-l2-1-2.dll
    api-ms-win-core-privateprofile-l1-1-0.dll
    api-ms-win-core-processthreads-l1-1-0.dll
    api-ms-win-core-file-l1-2-4.dll
    api-ms-win-security-base-l1-1-0.dll
    api-ms-win-security-lsalookup-l2-1-0.dll
    Cabinet.dll
    api-ms-win-core-file-l1-2-2.dll
    api-ms-win-core-kernel32-legacy-l1-1-0.dll
    api-ms-win-core-rtlsupport-l1-1-0.dll
    api-ms-win-core-profile-l1-1-0.dll
    DEVRTL.dll
    api-ms-win-core-version-l1-1-0.dll
    api-ms-win-core-synch-l1-1-0.dll
    api-ms-win-service-management-l1-1-0.dll
    api-ms-win-core-heap-l2-1-0.dll
    api-ms-win-core-heap-l1-1-0.dll
    api-ms-win-core-memory-l1-1-0.dll
    api-ms-win-core-io-l1-1-0.dll
    api-ms-win-security-sddl-l1-1-0.dll
    api-ms-win-core-localization-l1-2-0.dll
    api-ms-win-core-apiquery-l1-1-0.dll

  Image has the following delay load dependencies:

    drvstore.dll
    bcd.dll
    ext-ms-win-wevtapi-eventlog-l1-1-0.dll

  Section contains the following exports for PnpDiag.dll

    00000000 characteristics
    125F26E7 time date stamp
        0.00 version
           1 ordinal base
           2 number of functions
           2 number of names

    ordinal hint RVA      name

          1    0 00004D60 PnpDiagExportSystemState
          2    1 00005190 pPnpDiagExportSystemState

  Section contains the following imports:

    msvcrt.dll
             180033980 Import Address Table
             180040470 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4F7 toupper
                         370 _vsnprintf
                         3A1 _wcsnicmp
                         4E9 swprintf_s
                         347 _ultow_s
                         50F wcscmp
                         2B4 _resetstkoflw
                         51D wcsrchr
                         397 _wcsicmp
                         528 wcstoul
                         49E memcmp
                         49F memcpy
                         4A1 memmove
                         4A3 memset
                         189 _initterm
                         493 malloc
                         459 free
                          B7 _amsg_exit
                          5A _XcptFilter
                         50E wcschr
                         376 _vsnwprintf
                          5E __C_specific_handler

    api-ms-win-core-libraryloader-l1-2-0.dll
             180033608 Import Address Table
             1800400F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          16 GetProcAddress
                          10 GetModuleFileNameA
                          19 LoadLibraryExW
                           D FreeLibrary
                          18 LoadLibraryExA
                           1 DisableThreadLibraryCalls
                          15 GetModuleHandleW

    api-ms-win-core-sysinfo-l1-2-0.dll
             180033860 Import Address Table
             180040350 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 GetNativeSystemInfo
                          10 GetSystemFirmwareTable

    api-ms-win-core-registry-l1-1-0.dll
             180033708 Import Address Table
             1800401F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          11 RegFlushKey
                          16 RegLoadAppKeyW
                           5 RegDeleteKeyExW
                           3 RegCreateKeyExW
                          25 RegQueryValueExW
                          1E RegOpenKeyExW
                           0 RegCloseKey
                          18 RegLoadKeyW
                          2E RegSetValueExW
                          30 RegUnLoadKeyW
                          21 RegQueryInfoKeyW
                          29 RegSaveKeyExW
                          27 RegRestoreKeyW

    api-ms-win-core-string-l1-1-0.dll
             1800337B8 Import Address Table
             1800402A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 WideCharToMultiByte
                           6 MultiByteToWideChar
                           2 CompareStringW

    api-ms-win-core-errorhandling-l1-1-0.dll
             180033468 Import Address Table
             18003FF58 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           5 GetLastError
                           7 RaiseException
                           C SetErrorMode
                           D SetLastError
                          11 UnhandledExceptionFilter
                           F SetUnhandledExceptionFilter

    api-ms-win-core-file-l1-1-0.dll
             1800334A0 Import Address Table
             18003FF90 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 CreateFileW
                          3D GetTempFileNameW
                          1F FlushFileBuffers
                          55 SetFileAttributesW
                          5E WriteFile
                          58 SetFilePointer
                          36 GetFullPathNameW
                           D FindClose
                          2D GetFileAttributesW
                           A DeleteFileW
                          2E GetFileInformationByHandle
                          50 RemoveDirectoryW
                          1B FindNextFileW
                          51 SetEndOfFile
                           6 CreateFileA
                          15 FindFirstFileW
                           4 CreateDirectoryW
                          2F GetFileSize
                           9 DeleteFileA
                           C FileTimeToLocalFileTime
                          4C ReadFile

    CFGMGR32.dll
             1800333E0 Import Address Table
             18003FED0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          36 CM_Export_Pnp_StateW
                          22 CM_Enumerate_Classes

    api-ms-win-core-processenvironment-l1-1-0.dll
             180033698 Import Address Table
             180040188 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 GetCommandLineA
                           1 ExpandEnvironmentStringsW

    api-ms-win-devices-config-l1-1-1.dll
             1800338A8 Import Address Table
             180040398 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          69 CM_Get_Device_Interface_List_SizeW
                          32 CM_Get_Child
                          99 CM_MapCrToWin32Err
                          8B CM_Get_Sibling
                          5B CM_Get_Device_ID_List_SizeW
                          6C CM_Get_Device_Interface_PropertyW
                          53 CM_Get_Device_IDW
                          65 CM_Get_Device_Interface_ListW
                          57 CM_Get_Device_ID_ListW
                          48 CM_Get_DevNode_PropertyW
                          82 CM_Get_Parent
                          96 CM_Locate_DevNodeW

    ntdll.dll
             180033A38 Import Address Table
             180040528 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         463 RtlGetVersion
                         514 RtlNtStatusToDosErrorNoTeb
                         201 NtQuerySystemInformation
                         616 RtlUnicodeToMultiByteN
                         617 RtlUnicodeToMultiByteSize
                         101 NtClose
                         1E4 NtQueryInformationProcess
                         1B3 NtOpenProcess
                         24E NtSetInformationFile
                         1E1 NtQueryInformationFile
                         46D RtlImageNtHeader
                         410 RtlGUIDFromString
                         568 RtlRandomEx
                         406 RtlFreeHeap
                         2DE RtlAllocateHeap
                         506 RtlMultiByteToUnicodeSize
                         505 RtlMultiByteToUnicodeN
                         400 RtlFormatCurrentUserKeyPath
                         14B NtDeleteKey
                         1AA NtOpenKey
                         120 NtCreateKey
                         1EF NtQueryKey
                         206 NtQueryValueKey
                         26E NtSetValueKey
                         14E NtDeleteValueKey
                         15B NtEnumerateKey
                         1F5 NtQueryOpenSubKeysEx
                         566 RtlRaiseStatus
                         496 RtlInitializeSRWLock
                         2B8 RtlAcquireSRWLockExclusive
                         57D RtlReleaseSRWLockExclusive
                         360 RtlCreateUnicodeString
                         3CB RtlEqualUnicodeString
                         63A RtlValidRelativeSecurityDescriptor
                         4E6 RtlLengthSecurityDescriptor
                         482 RtlInitUnicodeStringEx
                         611 RtlUnicodeStringToInteger
                         1BD NtOpenThreadToken
                         1B4 NtOpenProcessToken
                         1FB NtQuerySecurityObject
                         157 NtDuplicateToken
                          CF NtAdjustPrivilegesToken
                         4E7 RtlLengthSid
                         33F RtlCopySid
                         345 RtlCreateAcl
                         2C4 RtlAddAce
                         358 RtlCreateSecurityDescriptor
                         5AF RtlSetDaclSecurityDescriptor
                         262 NtSetSecurityObject
                         15E NtEnumerateValueKey
                         156 NtDuplicateObject
                         1BE NtOpenThreadTokenEx
                         1B5 NtOpenProcessTokenEx
                         1E7 NtQueryInformationToken
                         3C9 RtlEqualSid
                         332 RtlConvertSidToUnicodeString
                         2E8 RtlAppendUnicodeStringToString
                         2BE RtlAddAccessAllowedAceEx
                         63B RtlValidSecurityDescriptor
                         2B2 RtlAbsoluteToSelfRelativeSD
                          78 LdrGetDllHandle
                         474 RtlInitAnsiString
                         52A RtlPrefixUnicodeString
                         5FA RtlTimeToTimeFields
                          23 DbgPrintEx
                         44C RtlGetSaclSecurityDescriptor
                         424 RtlGetDaclSecurityDescriptor
                         5B6 RtlSetGroupSecurityDescriptor
                         5BE RtlSetOwnerSecurityDescriptor
                         63C RtlValidSid
                         5EB RtlSubAuthoritySid
                         497 RtlInitializeSid
                         445 RtlGetOwnerSecurityDescriptor
                          AE LdrUnloadDll
                          80 LdrGetProcedureAddress
                          8A LdrLoadDll
                         255 NtSetInformationThread
                         289 NtUnloadKey2
                         481 RtlInitUnicodeString
                         513 RtlNtStatusToDosError
                         3A6 RtlDosPathNameToNtPathName_U
                         4D7 RtlIsStateSeparationEnabled
                         40D RtlFreeUnicodeString
                         433 RtlGetGroupSecurityDescriptor

    api-ms-win-core-registry-l2-1-0.dll
             180033778 Import Address Table
             180040268 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          18 RegSaveKeyW
                           A RegDeleteKeyW

    api-ms-win-core-synch-l1-2-0.dll
             180033810 Import Address Table
             180040300 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2D Sleep

    api-ms-win-core-sysinfo-l1-1-0.dll
             180033820 Import Address Table
             180040310 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          19 GetSystemWindowsDirectoryW
                          11 GetSystemInfo
                           5 GetLocalTime
                          16 GetSystemTimeAsFileTime
                          1B GetTickCount64
                          13 GetSystemTime
                          1A GetTickCount

    api-ms-win-core-timezone-l1-1-0.dll
             180033878 Import Address Table
             180040368 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           1 FileTimeToSystemTime

    api-ms-win-core-handle-l1-1-0.dll
             1800335A0 Import Address Table
             180040090 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseHandle

    api-ms-win-core-file-l2-1-0.dll
             180033578 Import Address Table
             180040068 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           8 MoveFileExW
                           5 CreateHardLinkW

    api-ms-win-core-file-l2-1-2.dll
             180033590 Import Address Table
             180040080 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 CopyFileW

    api-ms-win-core-privateprofile-l1-1-0.dll
             180033688 Import Address Table
             180040178 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           F WritePrivateProfileStringW

    api-ms-win-core-processthreads-l1-1-0.dll
             1800336B0 Import Address Table
             1800401A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           D GetCurrentProcessId
                          36 OpenThreadToken
                          52 SetThreadToken
                          55 TerminateProcess
                           C GetCurrentProcess
                          10 GetCurrentThread
                          11 GetCurrentThreadId
                          34 OpenProcessToken

    api-ms-win-core-file-l1-2-4.dll
             180033560 Import Address Table
             180040050 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          3F GetTempPath2W
                          3E GetTempPath2A

    api-ms-win-security-base-l1-1-0.dll
             180033910 Import Address Table
             180040400 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          2E FreeSid
                          1B CheckTokenMembership
                          29 DuplicateTokenEx
                          16 AllocateAndInitializeSid
                          15 AdjustTokenPrivileges
                          34 GetKernelObjectSecurity

    api-ms-win-security-lsalookup-l2-1-0.dll
             180033948 Import Address Table
             180040438 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 LookupPrivilegeValueW

    Cabinet.dll
             1800333F8 Import Address Table
             18003FEE8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    13
                             Ordinal    14
                             Ordinal    12
                             Ordinal    10
                             Ordinal    11

    api-ms-win-core-file-l1-2-2.dll
             180033550 Import Address Table
             180040040 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          3C GetTempFileNameA

    api-ms-win-core-kernel32-legacy-l1-1-0.dll
             1800335F8 Import Address Table
             1800400E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          17 FileTimeToDosDateTime

    api-ms-win-core-rtlsupport-l1-1-0.dll
             180033790 Import Address Table
             180040280 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         642 RtlVirtualUnwind
                         4FE RtlLookupFunctionEntry
                         31D RtlCompareMemory
                         2FE RtlCaptureContext

    api-ms-win-core-profile-l1-1-0.dll
             1800336F8 Import Address Table
             1800401E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 QueryPerformanceCounter

    DEVRTL.dll
             180033428 Import Address Table
             18003FF18 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 DevRtlSetThreadLogToken
                           2 DevRtlCreateTextLogSectionW
                           3 DevRtlGetThreadLogToken
                           5 DevRtlWriteTextLog
                           0 DevRtlCloseTextLogSection

    api-ms-win-core-version-l1-1-0.dll
             180033888 Import Address Table
             180040378 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           5 VerQueryValueW
                           0 GetFileVersionInfoExW
                           1 GetFileVersionInfoSizeExW

    api-ms-win-core-synch-l1-1-0.dll
             1800337D8 Import Address Table
             1800402C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          30 SleepEx
                          29 SetEvent
                          24 ReleaseSRWLockExclusive
                           0 AcquireSRWLockExclusive
                          37 WaitForSingleObjectEx
                           6 CreateEventW

    api-ms-win-service-management-l1-1-0.dll
             180033970 Import Address Table
             180040460 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 CloseServiceHandle

    api-ms-win-core-heap-l2-1-0.dll
             1800335D8 Import Address Table
             1800400C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A LocalFree

    api-ms-win-core-heap-l1-1-0.dll
             1800335B0 Import Address Table
             1800400A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           6 HeapFree
                           9 HeapReAlloc
                           0 GetProcessHeap
                           2 HeapAlloc

    api-ms-win-core-memory-l1-1-0.dll
             180033658 Import Address Table
             180040148 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          39 VirtualQuery
                          36 VirtualProtect
                          12 MapViewOfFile
                          29 UnmapViewOfFile
                           6 CreateFileMappingW

    api-ms-win-core-io-l1-1-0.dll
             1800335E8 Import Address Table
             1800400D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 DeviceIoControl

    api-ms-win-security-sddl-l1-1-0.dll
             180033958 Import Address Table
             180040448 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 ConvertStringSecurityDescriptorToSecurityDescriptorW
                           0 ConvertSecurityDescriptorToStringSecurityDescriptorW

    api-ms-win-core-localization-l1-2-0.dll
             180033648 Import Address Table
             180040138 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          35 LCMapStringW

    api-ms-win-core-apiquery-l1-1-0.dll
             180033458 Import Address Table
             18003FF48 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 ApiSetQueryApiSetPresence

  Section contains the following delay load imports:

    drvstore.dll
              00000001 Characteristics
      0000000180043720 Address of HMODULE
      0000000180047010 Import Address Table
      000000018003FA70 Import Name Table
      000000018003FAF8 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180001B01    1E DriverStoreGetObjectPropertyW
                                    0000000180001A76    18 DriverStoreEnumNodesW

    bcd.dll
              00000001 Characteristics
      0000000180043728 Address of HMODULE
      0000000180047000 Import Address Table
      000000018003FA60 Import Name Table
      000000018003FB10 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180001B13    10 BcdExportStore

    ext-ms-win-wevtapi-eventlog-l1-1-0.dll
              00000001 Characteristics
      0000000180043730 Address of HMODULE
      0000000180047028 Import Address Table
      000000018003FA88 Import Name Table
      000000018003FB20 Bound Import Name Table
      0000000000000000 Unload Import Name Table
                     0 time date stamp

                                    0000000180001B9E     6 EvtExportLog

  Summary

        2000 .data
        1000 .didat
        2000 .pdata
       12000 .rdata
        1000 .reloc
       30000 .text
